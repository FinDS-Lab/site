<!-- Header / Global Nav -->
<div class="sticky-blur">
  <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between gap-4">
    <!-- Brand -->
    <a href="{{ '/' | relative_url }}" class="flex items-center gap-3" aria-label="FINDS Lab Home">
      <img src="{{ '/assets/img/brand/logo-finds.png' | relative_url }}" alt="FINDS Lab Logo"
           class="h-9 w-9 rounded-lg ring-1 ring-slate-200 object-contain bg-white" />
      <div class="leading-tight">
        <div class="text-sm font-extrabold tracking-tight" style="color:var(--accent)">Financial Data Science Lab.</div>
        <div class="text-[12px] font-semibold" style="color:rgb(172,14,14)">Dongduk Women's University</div>
      </div>
    </a>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex items-center gap-6" aria-label="Primary">
      <a class="nav-link" href="{{ '/' | relative_url }}"><b>Home</b></a>

      <!-- About -->
      <div class="relative menu-group" data-menu>
        <!-- 메인 탭 클릭 시 기본 서브페이지(Introduction) -->
        <a class="nav-link" href="{{ '/about-introduction.html' | relative_url }}"><b>About FINDS</b></a>
        <div class="submenu-panel js-submenu" role="menu" aria-label="About FINDS submenu">
          <a class="block submenu-item" href="{{ '/about-introduction.html'  | relative_url }}" role="menuitem">Introduction</a>
          <a class="block submenu-item" href="{{ '/about-vision-area.html'   | relative_url }}" role="menuitem">Research Area</a>
          <a class="block submenu-item" href="{{ '/about-honors.html'        | relative_url }}" role="menuitem">Honors</a>
          <a class="block submenu-item" href="{{ '/about-location.html'      | relative_url }}" role="menuitem">Location</a>
        </div>
      </div>

      <!-- Members -->
      <div class="relative menu-group" data-menu>
        <!-- 메인 탭 클릭 시 기본 서브페이지(Director) -->
        <a class="nav-link" href="{{ '/members-director.html' | relative_url }}"><b>Members</b></a>
        <div class="submenu-panel js-submenu" role="menu" aria-label="Members submenu">
          <a class="block submenu-item" href="{{ '/members-director.html'   | relative_url }}" role="menuitem">Director</a>
          <a class="block submenu-item" href="{{ '/members-current.html'    | relative_url }}" role="menuitem">Current Students</a>
          <a class="block submenu-item" href="{{ '/members-alumni.html'     | relative_url }}" role="menuitem">Alumni</a>
        </div>
      </div>

      <a class="nav-link" href="{{ '/publications.html' | relative_url }}"><b>Publications</b></a>
      <a class="nav-link" href="{{ '/lectures.html'     | relative_url }}"><b>Lectures</b></a>
      <a class="nav-link" href="{{ '/projects.html'     | relative_url }}"><b>Projects</b></a>

      <!-- Archives -->
      <div class="relative menu-group" data-menu>
        <!-- 메인 탭 클릭 시 기본 서브페이지(News) -->
        <a class="nav-link" href="{{ '/archives-news.html' | relative_url }}"><b>Archives</b></a>
        <div class="submenu-panel js-submenu" role="menu" aria-label="Archives submenu">
          <a class="block submenu-item" href="{{ '/archives-news.html'    | relative_url }}" role="menuitem">News</a>
          <a class="block submenu-item" href="{{ '/about-notice.html'     | relative_url }}" role="menuitem">Notice</a>
          <a class="block submenu-item" href="{{ '/archives-seminar.html' | relative_url }}" role="menuitem">Seminar</a>
          <a class="block submenu-item" href="{{ '/archives-gallery.html' | relative_url }}" role="menuitem">Gallery</a>
        </div>
      </div>
    </nav>

    <!-- Mobile Toggle -->
    <div class="flex items-center gap-2">
      <button id="btnMobile" class="md:hidden inline-flex items-center justify-center h-10 w-10 rounded-lg border border-slate-200 bg-white"
              aria-label="Open menu" aria-expanded="false" aria-controls="mobileNav">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Nav -->
  <div id="mobileNav" class="md:hidden max-w-7xl mx-auto px-4 pb-3 hidden">
    <div class="grid gap-2 bg-white border border-slate-200 rounded-xl p-3 max-h-[70vh] overflow-y-auto">
      <a class="px-3 py-2 rounded-md font-extrabold mobile-link" href="{{ '/' | relative_url }}">Home</a>

      <!-- About (Accordion) -->
      <div class="px-3 py-2">
        <div class="flex items-center justify-between">
          <a class="block font-extrabold mb-1 mobile-link" href="{{ '/about-introduction.html' | relative_url }}">About FINDS</a>
          <button class="mobile-acc-btn" aria-expanded="false" aria-controls="mob-about" aria-label="Toggle About submenu">▾</button>
        </div>
        <div id="mob-about" class="pl-3 grid text-[14px] mobile-acc-panel hidden">
          <a class="py-1 font-bold mobile-link" href="{{ '/about-introduction.html' | relative_url }}">Introduction</a>
          <a class="py-1 font-bold mobile-link" href="{{ '/about-vision-area.html'  | relative_url }}">Research Area</a>
          <a class="py-1 font-bold mobile-link" href="{{ '/about-honors.html'       | relative_url }}">Honors</a>
          <a class="py-1 font-bold mobile-link" href="{{ '/about-location.html'     | relative_url }}">Location</a>
        </div>
      </div>

      <!-- Members (Accordion) -->
      <div class="px-3 py-2">
        <div class="flex items-center justify-between">
          <a class="block font-extrabold mb-1 mobile-link" href="{{ '/members-director.html' | relative_url }}">Members</a>
          <button class="mobile-acc-btn" aria-expanded="false" aria-controls="mob-members" aria-label="Toggle Members submenu">▾</button>
        </div>
        <div id="mob-members" class="pl-3 grid text-[14px] mobile-acc-panel hidden">
          <a class="py-1 font-bold mobile-link" href="{{ '/members-director.html'   | relative_url }}">Director</a>
          <a class="py-1 font-bold mobile-link" href="{{ '/members-current.html'    | relative_url }}">Current Students</a>
          <a class="py-1 font-bold mobile-link" href="{{ '/members-alumni.html'     | relative_url }}">Alumni</a>
        </div>
      </div>

      <a class="px-3 py-2 rounded-md font-extrabold mobile-link" href="{{ '/publications.html' | relative_url }}">Publications</a>
      <a class="px-3 py-2 rounded-md font-extrabold mobile-link" href="{{ '/lectures.html'     | relative_url }}">Lectures</a>
      <a class="px-3 py-2 rounded-md font-extrabold mobile-link" href="{{ '/projects.html'     | relative_url }}">Projects</a>

      <!-- Archives (Accordion) -->
      <div class="px-3 py-2">
        <div class="flex items-center justify-between">
          <a class="block font-extrabold mb-1 mobile-link" href="{{ '/archives-news.html' | relative_url }}">Archives</a>
          <button class="mobile-acc-btn" aria-expanded="false" aria-controls="mob-archives" aria-label="Toggle Archives submenu">▾</button>
        </div>
        <div id="mob-archives" class="pl-3 grid text-[14px] mobile-acc-panel hidden">
          <a class="py-1 font-bold mobile-link" href="{{ '/archives-news.html'    | relative_url }}">News</a>
          <a class="py-1 font-bold mobile-link" href="{{ '/about-notice.html'     | relative_url }}">Notice</a>
          <a class="py-1 font-bold mobile-link" href="{{ '/archives-seminar.html' | relative_url }}">Seminar</a>
          <a class="py-1 font-bold mobile-link" href="{{ '/archives-gallery.html' | relative_url }}">Gallery</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Interaction (지연 열림/닫힘 + 모바일 토글/아코디언) -->
<script>
  (function () {
    // 데스크톱: hover intent (약간 늦게 열리고/닫히게)
    const groups = document.querySelectorAll('[data-menu]');
    groups.forEach(g => {
      let enterTO, leaveTO;
      const open = () => {
        clearTimeout(leaveTO);
        enterTO = setTimeout(() => g.setAttribute('data-open', 'true'), 80);
      };
      const close = () => {
        clearTimeout(enterTO);
        leaveTO = setTimeout(() => g.removeAttribute('data-open'), 120);
      };
      g.addEventListener('mouseenter', open);
      g.addEventListener('mouseleave', close);
      g.addEventListener('focusin', open);
      g.addEventListener('focusout', close);
    });

    // 모바일 메뉴 토글
    const btn = document.getElementById('btnMobile');
    const panel = document.getElementById('mobileNav');
    if (btn && panel){
      btn.addEventListener('click', () => {
        const hidden = panel.classList.contains('hidden');
        panel.classList.toggle('hidden');
        btn.setAttribute('aria-expanded', String(hidden));
        document.body.classList.toggle('no-scroll', hidden);
      });
    }

    // 모바일 아코디언
    document.querySelectorAll('.mobile-acc-btn').forEach((accBtn) => {
      accBtn.addEventListener('click', () => {
        const panelId = accBtn.getAttribute('aria-controls');
        const accPanel = document.getElementById(panelId);
        const expanded = accBtn.getAttribute('aria-expanded') === 'true';
        accBtn.setAttribute('aria-expanded', String(!expanded));
        accPanel.classList.toggle('hidden');
      });
    });
  })();
</script>
