---
layout: default
title: gallery
permalink: /archives-gallery.html
---

<!-- ===== Gallery Styles ===== -->
<style>
  .breadcrumbs{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;font-size:12px}
  .breadcrumbs a{color:#e5e7eb}
  .breadcrumbs a:hover{text-decoration:underline}
  .breadcrumbs .sep{opacity:.85}

  .gal-toolbar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;background:#f8fafc;border:1px solid #e5e7eb;border-radius:1rem;padding:12px 14px;margin-top:18px}
  .gal-search{flex:1 1 260px}
  .gal-search input{width:100%;border:1px solid #e5e7eb;border-radius:.6rem;padding:.55rem .8rem;font-size:14px}
  .gal-count{font-size:12px;font-weight:800;color:#64748b}

  .gal-grid{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:16px}
  @media (min-width:640px){ .gal-grid{grid-template-columns:repeat(2,minmax(0,1fr))} }
  @media (min-width:1024px){ .gal-grid{grid-template-columns:repeat(3,minmax(0,1fr))} }

  .gal-card{display:block;border:1px solid #e5e7eb;border-radius:1rem;overflow:hidden;background:#fff;transition:transform .2s ease, box-shadow .2s ease}
  .gal-card:hover{transform:translateY(-2px);box-shadow:0 10px 28px rgba(0,0,0,.08)}
  .gal-thumb{height:180px;background-size:cover;background-position:center}
  .gal-info{padding:12px 14px}
  .gal-title{font-weight:900;font-size:15px;color:#0f172a;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  .gal-date{margin-top:4px;font-size:12px;color:#6b7280}
  .gal-tags{margin-top:8px;display:flex;flex-wrap:wrap;gap:6px}
  .gal-tag{font-size:11px;font-weight:800;border:1px solid #e5e7eb;border-radius:999px;background:#fff;color:#111827;padding:.15rem .5rem}

  .gal-empty{padding:32px;text-align:center;color:#6b7280;font-weight:700;border:1px dashed #e5e7eb;border-radius:1rem;background:#fff}
</style>

<!-- ===== Page Title / Banner ===== -->
<section class="max-w-7xl mx-auto px-4 mt-6">
  <div class="relative rounded-2xl overflow-hidden ring-1 ring-slate-200">
    <img src="{{ '/assets/img/banners/news-hero.jpg' | relative_url }}" alt="Gallery banner"
         class="w-full h-[200px] md:h-[260px] object-cover" width="1600" height="320">
    <div class="absolute inset-0 bg-black/45"></div>
    <div class="absolute inset-x-0 bottom-4 px-4">
      <div class="max-w-7xl mx-auto text-white">
        <nav aria-label="Breadcrumb" class="breadcrumbs mb-1">
          <a href="{{ '/' | relative_url }}">Home</a>
          <span class="sep">›</span>
          <span>Archives</span>
          <span class="sep">›</span>
          <span aria-current="page" class="font-semibold">Gallery</span>
        </nav>
        <h1 class="text-2xl md:text-3xl font-extrabold">Lab Gallery</h1>
      </div>
    </div>
  </div>
</section>

<!-- ===== Toolbar ===== -->
<section class="max-w-7xl mx-auto px-4">
  <div class="gal-toolbar">
    <div class="gal-search">
      <input id="gal-q" type="text" placeholder="Search by title or tag…">
    </div>
    <div class="gal-count" id="gal-count"></div>
  </div>
</section>

<!-- ===== Gallery List (pull from folders too) ===== -->
<section class="max-w-7xl mx-auto px-4 mt-6">
  {% comment %}
    1) 모든 페이지/포스트 + 모든 컬렉션의 문서까지 합쳐서(all_items)
    2) URL에 '/gallery/' 포함 & 제목 있는 것만 필터
    3) 최신(date) 우선 정렬. date 없으면 뒤쪽으로 감.
  {% endcomment %}

  {% assign all_items = site.pages | concat: site.posts %}

  {% for c in site.collections %}
    {% unless c.label == 'posts' %}
      {% assign all_items = all_items | concat: c.docs %}
    {% endunless %}
  {% endfor %}

  {% assign galleries = "" | split: "" %}
  {% for item in all_items %}
    {% if item.url and item.title and item.url contains '/gallery/' and item.url != '/archives-gallery.html' %}
      {% assign galleries = galleries | push: item %}
    {% endif %}
  {% endfor %}

  {%- comment -%}
    날짜가 없는 페이지도 있을 수 있으므로, 먼저 date 있는 것 / 없는 것 분리 후 합치기
  {%- endcomment -%}
  {% assign dated = "" | split: "" %}
  {% assign undated = "" | split: "" %}
  {% for g in galleries %}
    {% if g.date %}
      {% assign dated = dated | push: g %}
    {% else %}
      {% assign undated = undated | push: g %}
    {% endif %}
  {% endfor %}
  {% assign dated = dated | sort: 'date' | reverse %}
  {% assign galleries_sorted = dated | concat: undated %}

  {% if galleries_sorted.size == 0 %}
    <div class="gal-empty">게시글이 없습니다.</div>
  {% else %}
    <ul id="gal-grid" class="gal-grid" role="list">
      {% for post in galleries_sorted %}
        {%- comment -%}
          썸네일 결정 우선순위:
          1) front matter: thumb / image / cover
          2) 같은 폴더의 첫 번째 이미지(site.static_files에서 post.url 포함 경로 탐색)
          3) 플레이스홀더
        {%- endcomment -%}
        {%- assign raw_thumb = post.thumb | default: post.image | default: post.cover -%}
        {%- assign thumb_url = nil -%}

        {%- if raw_thumb -%}
          {%- if raw_thumb contains '://' or raw_thumb startswith '/' -%}
            {%- assign thumb_url = raw_thumb | relative_url -%}
          {%- else -%}
            {%- assign base = post.url -%}
            {%- assign last = base | slice: -1, 1 -%}
            {%- if last != '/' -%}{% assign base = base | append: '/' %}{%- endif -%}
            {%- assign thumb_url = base | append: raw_thumb | relative_url -%}
          {%- endif -%}
        {%- endif -%}

        {%- if thumb_url == nil -%}
          {%- assign cand = site.static_files | where_exp: "f", "f.path contains post.url" -%}
          {%- assign imgs1 = cand | where: "extname", ".jpg" -%}
          {%- assign imgs2 = cand | where: "extname", ".jpeg" -%}
          {%- assign imgs3 = cand | where: "extname", ".png" -%}
          {%- assign imgs4 = cand | where: "extname", ".webp" -%}
          {%- assign images = imgs1 | concat: imgs2 | concat: imgs3 | concat: imgs4 -%}
          {%- assign first = images[0] -%}
          {%- if first -%}{% assign thumb_url = first.path | relative_url %}{%- endif -%}
        {%- endif -%}

        {%- unless thumb_url -%}
          {%- assign thumb_url = '/assets/img/placeholders/gallery.jpg' | relative_url -%}
        {%- endunless -%}

        {%- assign date_txt = '' -%}
        {%- if post.date -%}
          {%- assign date_txt = post.date | date: "%Y.%m.%d" -%}
        {%- endif -%}

        {%- assign tag_text = '' -%}
        {%- if post.tags and post.tags.size > 0 -%}
          {%- assign tag_text = post.tags | join: ' ' -%}
        {%- endif -%}

        <li class="gal-item" role="listitem" data-text="{{ post.title | escape }} {{ tag_text | escape }}">
          <a class="gal-card" href="{{ post.url | relative_url }}">
            <div class="gal-thumb" style="background-image:url('{{ thumb_url }}')"></div>
            <div class="gal-info">
              <h3 class="gal-title">{{ post.title }}</h3>
              {% if date_txt != '' %}<p class="gal-date">{{ date_txt }}</p>{% endif %}
              {% if post.tags and post.tags.size > 0 %}
                <div class="gal-tags">
                  {% for t in post.tags %}
                    <span class="gal-tag">#{{ t }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
          </a>
        </li>
      {% endfor %}
    </ul>
  {% endif %}
</section>

<!-- ===== Page JS (검색) ===== -->
<script>
  (function(){
    const q = document.getElementById('gal-q');
    const grid = document.getElementById('gal-grid');
    const cnt = document.getElementById('gal-count');
    if(!q || !grid) return;

    const items = Array.from(grid.querySelectorAll('.gal-item'));
    const total = items.length;

    function renderCount(n){ cnt.textContent = `Showing ${n} of ${total}`; }

    function applyFilter(){
      const term = q.value.trim().toLowerCase();
      let visible = 0;
      items.forEach(li => {
        const text = (li.getAttribute('data-text') || '').toLowerCase();
        const show = !term || text.includes(term);
        li.style.display = show ? '' : 'none';
        if(show) visible++;
      });
      renderCount(visible);
    }

    renderCount(total);
    q.addEventListener('input', applyFilter);
  })();
</script>
