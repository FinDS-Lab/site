---
layout: default
title: gallery
permalink: /archives-gallery.html
---

<!-- ===== Styles ===== -->
<style>
  /* Breadcrumbs */
  .breadcrumbs{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;font-size:12px}
  .breadcrumbs a{color:#e5e7eb}
  .breadcrumbs a:hover{text-decoration:underline}
  .breadcrumbs .sep{opacity:.8}

  /* Search Container */
  .search-container{
    display:flex;align-items:center;gap:12px;flex-wrap:wrap;
    background:#f8fafc;border:1px solid #e5e7eb;border-radius:1rem;padding:16px;margin-top:20px;
  }
  .search-box{flex:1;min-width:0;}
  .search-box input{width:100%;border:1px solid #e5e7eb;border-radius:.6rem;padding:.6rem .8rem;font-size:14px;box-sizing:border-box;}
  .search-count{font-size:13px;color:#6b7280;font-weight:600;background:#fff;padding:.4rem .8rem;border:1px solid #e5e7eb;border-radius:.5rem;white-space:nowrap;}

  /* Gallery Grid */
  .gallery-grid{display:grid;gap:20px;margin-top:24px;grid-template-columns:repeat(auto-fill, minmax(280px, 1fr));}
  @media (max-width: 640px){
    .gallery-grid{grid-template-columns:1fr;gap:16px;}
    .search-count{text-align:center;width:100%;}
  }

  /* Gallery Card */
  .gallery-card{background:#fff;border:1px solid #e5e7eb;border-radius:1rem;overflow:hidden;transition:all .2s;cursor:pointer;display:flex;flex-direction:column;}
  .gallery-card:hover{transform:translateY(-4px);box-shadow:0 12px 32px rgba(0,0,0,.1);}

  /* Thumbnail */
  .gallery-thumb{
    width:100%;height:200px;background-color:#f3f4f6;background-size:cover;background-position:center;background-repeat:no-repeat;position:relative;overflow:hidden;
  }
  .gallery-thumb::after{content:'';position:absolute;inset:0;background:linear-gradient(to bottom, transparent 70%, rgba(0,0,0,.3));opacity:0;transition:opacity .2s;}
  .gallery-card:hover .gallery-thumb::after{opacity:1;}

  /* Card Content */
  .gallery-content{padding:16px;flex:1;display:flex;flex-direction:column;}

  /* Date Badge */
  .gallery-date{
    display:inline-flex;align-items:center;padding:3px 8px;background:#f8fafc;border:1px solid #e5e7eb;border-radius:999px;font-size:11px;font-weight:600;color:#6b7280;margin-bottom:10px;align-self:flex-start;
  }

  /* Title */
  .gallery-title{
    font-size:16px;font-weight:800;color:#111827;line-height:1.4;margin-bottom:8px;
    display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;
  }

  /* Tags */
  .gallery-tags{display:flex;flex-wrap:wrap;gap:6px;margin-top:auto;padding-top:12px;}
  .gallery-tag{display:inline-flex;padding:3px 10px;background:#fff;border:1px solid #e5e7eb;border-radius:999px;font-size:11px;font-weight:600;color:#374151;}

  /* Modal Styles */
  .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:9998;display:none;opacity:0;transition:opacity .3s;}
  .modal-overlay.show{display:block;opacity:1;}
  .modal-panel{
    position:fixed;top:50%;left:50%;transform:translate(-50%, -50%) scale(.95);
    width:90%;max-width:1100px;max-height:85vh;background:#fff;border-radius:1rem;z-index:9999;display:none;opacity:0;transition:all .3s;overflow:hidden;
  }
  .modal-panel.show{display:flex;flex-direction:column;opacity:1;transform:translate(-50%, -50%) scale(1);}

  /* Modal Header */
  .modal-header{padding:16px 20px;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center;background:#f8fafc;position:sticky;top:0;z-index:1;}
  .modal-title{font-size:18px;font-weight:900;color:#111827;margin-right:8px;}
  .modal-close{width:36px;height:36px;border-radius:.5rem;border:none;background:#fff;color:#111827;font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;}
  .modal-close:hover{background:#e5e7eb;}

  /* Secondary close for mobile (bottom sticky) */
  .modal-footer{
    display:none;position:sticky;bottom:0;background:#fff;border-top:1px solid #e5e7eb;padding:10px;z-index:1;
  }
  .modal-close-mobile{
    width:100%;padding:12px 16px;border-radius:.75rem;border:1px solid #e5e7eb;background:#111827;color:#fff;font-weight:800;font-size:14px;
  }
  @media (max-width:640px){
    .modal-footer{display:block;}
  }

  /* Modal Body */
  .modal-body{flex:1;overflow-y:auto;padding:16px 20px;}
  .modal-meta{display:flex;align-items:center;gap:12px;margin-bottom:16px;flex-wrap:wrap;}
  .modal-date{display:inline-flex;align-items:center;padding:4px 12px;background:#111827;color:#fff;border-radius:999px;font-size:12px;font-weight:700;}
  .modal-tags-container{display:flex;gap:8px;flex-wrap:wrap;}
  .modal-tag{display:inline-flex;padding:4px 12px;background:#f8fafc;border:1px solid #e5e7eb;border-radius:999px;font-size:12px;font-weight:600;color:#374151;}

  /* Dynamic Gallery Grid in Modal */
  .modal-gallery{
    display:grid;gap:12px;margin-top:12px;
  }
  /* 이미지 카드: 16:9 비율로 보기 편하게 */
  .modal-image{position:relative;width:100%;border-radius:.75rem;overflow:hidden;background:#0f172a;}
  .modal-image::before{content:"";display:block;padding-top:56.25%;} /* 16:9 */
  .modal-image > img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;}

  /* Lightbox */
  .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.95);z-index:10000;display:none;align-items:center;justify-content:center;padding:20px;}
  .lightbox.show{display:flex;}
  .lightbox-image{max-width:100%;max-height:100%;object-fit:contain;}
  .lightbox-close{
    position:absolute;top:20px;right:20px;width:40px;height:40px;background:rgba(255,255,255,.1);
    border:2px solid rgba(255,255,255,.3);border-radius:50%;color:#fff;font-size:24px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;
  }
  .lightbox-close:hover{background:rgba(255,255,255,.2);transform:scale(1.1);}

  /* Empty State */
  .empty-state{grid-column:1/-1;padding:60px 20px;text-align:center;}
  .empty-icon{width:80px;height:80px;margin:0 auto 20px;background:#f3f4f6;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;}
  .empty-title{font-size:18px;font-weight:800;color:#111827;margin-bottom:8px;}
  .empty-text{font-size:14px;color:#6b7280;}

  /* Mobile tweaks */
  @media (max-width:640px){
    .search-container{flex-direction:column;align-items:stretch;gap:12px;}
    .search-box{width:100%;}
    .gallery-thumb{height:160px;}
    .gallery-title{font-size:15px;}
    .modal-panel{width:100%;height:100%;max-width:100%;max-height:100%;border-radius:0;}
  }
</style>

<!-- ===== Page Title / Banner ===== -->
<section class="max-w-7xl mx-auto px-4 mt-6">
  <div class="relative rounded-2xl overflow-hidden ring-1 ring-slate-200">
    <img src="{{ '/assets/img/banners/gallery-hero.jpg' | relative_url }}"
         alt="Gallery"
         class="w-full h-[200px] md:h-[260px] object-cover"
         width="1600" height="320"
         loading="lazy" decoding="async"
         onerror="this.onerror=null; this.style.display='none';">
    <div class="absolute inset-0 bg-black/45"></div>
    <div class="absolute inset-x-0 bottom-4 px-4">
      <div class="max-w-7xl mx-auto text-white">
        <nav aria-label="Breadcrumb" class="breadcrumbs mb-1">
          <a href="{{ '/' | relative_url }}">Home</a>
          <span class="sep">›</span>
          <span>Archives</span>
          <span class="sep">›</span>
          <span aria-current="page" class="font-semibold">Gallery</span>
        </nav>
        <h1 class="text-2xl md:text-3xl font-extrabold">Gallery</h1>
      </div>
    </div>
  </div>
</section>

<!-- ===== Search ===== -->
<section class="max-w-7xl mx-auto px-4">
  <div class="search-container">
    <div class="search-box">
      <input id="searchInput" type="text" placeholder="Search by title or tags...">
    </div>
    <div class="search-count" id="searchCount">Loading...</div>
  </div>
</section>

<!-- ===== Gallery Grid (Jekyll Integration) ===== -->
<section class="max-w-7xl mx-auto px-4 pb-8">
  {% comment %} Collect and sort gallery pages {% endcomment %}
  {% assign all_items = site.pages | concat: site.posts %}
  {% assign galleries = "" | split: "" %}
  {% for item in all_items %}
    {% if item.url contains '/gallery/' and item.url != '/archives-gallery.html' and item.title %}
      {% assign galleries = galleries | push: item %}
    {% endif %}
  {% endfor %}
  {% assign dated = "" | split: "" %}
  {% assign undated = "" | split: "" %}
  {% for g in galleries %}
    {% if g.date %}{% assign dated = dated | push: g %}{% else %}{% assign undated = undated | push: g %}{% endif %}
  {% endfor %}
  {% assign dated = dated | sort: 'date' | reverse %}
  {% assign galleries_sorted = dated | concat: undated %}

  {% if galleries_sorted.size == 0 %}
    <div class="empty-state">
      <div class="empty-icon">📷</div>
      <div class="empty-title">No gallery items found</div>
      <div class="empty-text">Gallery albums will appear here once created</div>
    </div>
  {% else %}
    <div class="gallery-grid" id="galleryGrid">
      {% for gallery in galleries_sorted %}
        {% assign thumb_url = nil %}
        {% if gallery.thumb %}
          {% if gallery.thumb contains '://' or gallery.thumb[0] == '/' %}
            {% assign thumb_url = gallery.thumb | relative_url %}
          {% else %}
            {% assign base = gallery.url %}
            {% if base[-1] != '/' %}{% assign base = base | append: '/' %}{% endif %}
            {% assign thumb_url = base | append: gallery.thumb | relative_url %}
          {% endif %}
        {% endif %}

        {% if thumb_url == nil %}
          {% assign gallery_files = site.static_files | where_exp: "f", "f.path contains gallery.url" %}
          {% assign images = "" | split: "" %}
          {% for f in gallery_files %}
            {% assign ext = f.extname | downcase %}
            {% if ext == '.jpg' or ext == '.jpeg' or ext == '.png' or ext == '.webp' %}
              {% assign images = images | push: f %}
            {% endif %}
          {% endfor %}
          {% if images.size > 0 %}
            {% assign thumb_url = images[0].path | relative_url %}
          {% endif %}
        {% endif %}

        {% unless thumb_url %}
          {% assign thumb_url = '/assets/img/placeholders/gallery.jpg' | relative_url %}
        {% endunless %}

        {% assign search_text = gallery.title | downcase %}
        {% if gallery.tags %}
          {% assign tags_text = gallery.tags | join: ' ' | downcase %}
          {% assign search_text = search_text | append: ' ' | append: tags_text %}
        {% endif %}

        <div class="gallery-card"
             data-search="{{ search_text | escape }}"
             data-title="{{ gallery.title | escape }}"
             data-date="{{ gallery.date | date: '%b %d, %Y' }}"
             data-tags="{{ gallery.tags | join: ',' | escape }}"
             data-url="{{ gallery.url | relative_url }}"
             data-images="{{ images | map: 'path' | join: ',' | relative_url }}"
             onclick="openGalleryModal(this)">
          <div class="gallery-thumb" style="background-image:url('{{ thumb_url }}')"></div>
          <div class="gallery-content">
            {% if gallery.date %}
              <span class="gallery-date">{{ gallery.date | date: "%b %d, %Y" }}</span>
            {% endif %}
            <h3 class="gallery-title">{{ gallery.title }}</h3>
            {% if gallery.tags and gallery.tags.size > 0 %}
              <div class="gallery-tags">
                {% for tag in gallery.tags %}
                  <span class="gallery-tag">#{{ tag }}</span>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
</section>

<!-- ===== Modal ===== -->
<div class="modal-overlay" id="modalOverlay" onclick="closeGalleryModal()"></div>
<div class="modal-panel" id="modalPanel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div class="modal-header">
    <h3 class="modal-title" id="modalTitle">Gallery</h3>
    <button type="button" class="modal-close" aria-label="Close" onclick="closeGalleryModal()">✕</button>
  </div>
  <div class="modal-body" id="modalBody"><!-- Content will be inserted here --></div>
  <!-- Mobile friendly close -->
  <div class="modal-footer">
    <button type="button" class="modal-close-mobile" onclick="closeGalleryModal()">Close</button>
  </div>
</div>

<!-- ===== Lightbox ===== -->
<div class="lightbox" id="lightbox" onclick="closeLightbox()">
  <button class="lightbox-close" onclick="closeLightbox()">✕</button>
  <img class="lightbox-image" id="lightboxImage" alt="">
</div>

<!-- ===== Scripts ===== -->
<script>
/* Open Gallery Modal with dynamic grid */
function openGalleryModal(card){
  const title = card.dataset.title;
  const date = card.dataset.date;
  const tags = card.dataset.tags ? card.dataset.tags.split(',').filter(Boolean) : [];
  const url  = card.dataset.url;
  const images = card.dataset.images ? card.dataset.images.split(',').filter(Boolean) : [];

  // Title
  document.getElementById('modalTitle').textContent = title;

  // Meta
  let bodyContent = '<div class="modal-meta">';
  if (date) bodyContent += `<span class="modal-date">${date}</span>`;
  if (tags.length){
    bodyContent += '<div class="modal-tags-container">';
    tags.forEach(tag => bodyContent += `<span class="modal-tag">#${tag}</span>`);
    bodyContent += '</div>';
  }
  bodyContent += '</div>';

  // Dynamic grid builder
  const n = images.length;

  // Decide columns/rows pattern
  let cols = 1, rows = 1;
  if (n === 1){ cols = 1; rows = 1; }
  else if (n === 2){ cols = 2; rows = 1; }
  else if (n === 3){ cols = 3; rows = 1; }
  else if (n === 4){ cols = 2; rows = 2; }
  else if (n === 5){ cols = 3; rows = 2; }
  else if (n >= 6){ cols = 3; rows = 2; } // 6 이상은 2행 3열 블록으로, 이후 줄단위로 흐르게

  // Build gallery
  if (n > 0){
    bodyContent += `<div class="modal-gallery" id="modalGallery" style="grid-template-columns:repeat(${cols}, 1fr);">`;
    images.forEach((img, idx) => {
      bodyContent += `
        <div class="modal-image" onclick="openLightbox('${img}')" role="button" aria-label="Open image ${idx+1}">
          <img src="${img}" alt="" loading="lazy" decoding="async" onerror="this.onerror=null; this.style.display='none';">
        </div>`;
    });
    bodyContent += '</div>';
  } else {
    bodyContent += `
      <div class="empty-state" style="padding:40px 20px;">
        <div class="empty-icon">🖼️</div>
        <div class="empty-title">No images available</div>
        <div class="empty-text">Images will be displayed here once uploaded</div>
      </div>`;
  }

  // Inject
  const bodyEl = document.getElementById('modalBody');
  bodyEl.innerHTML = bodyContent;

  // Center single image at large viewports by max width
  if (n === 1){
    const g = document.getElementById('modalGallery');
    if (g){
      g.style.maxWidth = '1200px';  // 1920x1080에서 적절히 중앙정렬
      g.style.margin = '0 auto';
    }
  }

  // Show modal
  document.getElementById('modalOverlay').classList.add('show');
  document.getElementById('modalPanel').classList.add('show');
  document.body.style.overflow = 'hidden';

  // Enable swipe-down to close on mobile
  enableSwipeClose(document.getElementById('modalPanel'));
}

/* Close Gallery Modal */
function closeGalleryModal(){
  document.getElementById('modalOverlay').classList.remove('show');
  document.getElementById('modalPanel').classList.remove('show');
  document.body.style.overflow = '';
}

/* Lightbox */
function openLightbox(imageSrc){
  event.stopPropagation();
  const img = document.getElementById('lightboxImage');
  img.src = imageSrc;
  document.getElementById('lightbox').classList.add('show');
}
function closeLightbox(){
  document.getElementById('lightbox').classList.remove('show');
}

/* ESC and overlay close */
document.addEventListener('keydown', function(e){
  if (e.key === 'Escape'){
    const lb = document.getElementById('lightbox');
    if (lb.classList.contains('show')) closeLightbox();
    else if (document.getElementById('modalPanel').classList.contains('show')) closeGalleryModal();
  }
});

/* Search */
(function(){
  const searchInput = document.getElementById('searchInput');
  const searchCount = document.getElementById('searchCount');
  const galleryGrid = document.getElementById('galleryGrid');
  if (!searchInput || !galleryGrid) return;

  const cards = Array.from(galleryGrid.querySelectorAll('.gallery-card'));
  const totalCount = cards.length;

  function updateCount(visible){ searchCount.textContent = visible + ' of ' + totalCount; }

  function filterGallery(){
    const term = searchInput.value.toLowerCase().trim();
    let visible = 0;
    cards.forEach(card => {
      const text = card.dataset.search || '';
      const match = !term || text.includes(term);
      card.style.display = match ? '' : 'none';
      if (match) visible++;
    });
    updateCount(visible);
    // empty state
    if (visible === 0 && term){
      if (!document.getElementById('searchEmpty')){
        const emptyDiv = document.createElement('div');
        emptyDiv.id = 'searchEmpty';
        emptyDiv.className = 'empty-state';
        emptyDiv.innerHTML = `
          <div class="empty-icon">🔍</div>
          <div class="empty-title">No results found</div>
          <div class="empty-text">Try adjusting your search term</div>`;
        galleryGrid.appendChild(emptyDiv);
      }
    } else {
      const empty = document.getElementById('searchEmpty');
      if (empty) empty.remove();
    }
  }
  updateCount(totalCount);
  searchInput.addEventListener('input', filterGallery);
})();

/* Swipe-down to close (mobile-friendly) */
function enableSwipeClose(panel){
  let startY = null, startX = null, moved = false;
  function onTouchStart(e){
    const t = e.touches[0]; startY = t.clientY; startX = t.clientX; moved = false;
  }
  function onTouchMove(e){
    if (startY === null) return;
    const t = e.touches[0];
    const dy = t.clientY - startY;
    const dx = t.clientX - startX;
    if (Math.abs(dy) > Math.abs(dx) && dy > 30){ moved = true; }
  }
  function onTouchEnd(){
    if (moved) closeGalleryModal();
    startY = startX = null; moved = false;
  }
  panel.removeEventListener('touchstart', onTouchStart);
  panel.removeEventListener('touchmove', onTouchMove);
  panel.removeEventListener('touchend', onTouchEnd);
  panel.addEventListener('touchstart', onTouchStart, {passive:true});
  panel.addEventListener('touchmove', onTouchMove, {passive:true});
  panel.addEventListener('touchend', onTouchEnd, {passive:true});
}
</script>
