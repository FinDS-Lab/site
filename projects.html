<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Projects | FINDS Lab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="FINDS Lab — Projects with funding/status filters." />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700&family=Noto+Sans:wght@400;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <!-- CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <style>
    :root{ --warm-start:#ef4444; --warm-end:#f59e0b; }
    body{font-family:"Noto Sans KR","Noto Sans","Roboto",system-ui,-apple-system,"Segoe UI",Arial,sans-serif;letter-spacing:.01em}
    .sticky-blur{position:sticky;top:0;z-index:50;backdrop-filter:saturate(180%) blur(6px);-webkit-backdrop-filter:saturate(180%) blur(6px)}
    .card-hover{transition:transform .2s ease, box-shadow .2s ease}
    .card-hover:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.08)}
    *{scrollbar-width:thin;scrollbar-color:#f59e0b #f1f5f9}
    *::-webkit-scrollbar{height:8px;width:8px}
    *::-webkit-scrollbar-thumb{background:#f59e0b;border-radius:9999px}
    *::-webkit-scrollbar-track{background:#f1f5f9}
  </style>
</head>
<body class="bg-gradient-to-b from-white to-slate-50 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const {useMemo,useState} = React;

    const WARM_START = getComputedStyle(document.documentElement).getPropertyValue('--warm-start') || '#ef4444';
    const WARM_END   = getComputedStyle(document.documentElement).getPropertyValue('--warm-end')   || '#f59e0b';
    const warmScale  = d3.interpolateLab(WARM_START, WARM_END);
    const readable = (bg)=>{ const c=d3.color(bg)||{r:255,g:255,b:255}; const L=(0.2126*c.r+0.7152*c.g+0.0722*c.b)/255; return L<0.55?'#fff':'#111827'; }
    const pickWarm = (key)=>{ let h=0; const s=String(key||''); for(let i=0;i<s.length;i++) h=(h*31+s.charCodeAt(i))>>>0; return warmScale((h%16)/15); }

    const Tag=({text})=>{ const bg=pickWarm(text); return <span className="px-2 py-0.5 text-[12px] font-semibold rounded-full inline-flex items-center" style={{backgroundColor:bg,color:readable(bg),boxShadow:'inset 0 0 0 1px rgba(0,0,0,.06)'}}>{text}</span> }
    const FilterChip=({text,selected,onClick})=>{ const base=pickWarm(text); const bg=selected?base:d3.interpolateLab(base,'#ffffff')(0.75); const border=d3.interpolateLab(base,'#000')(0.18); return <button onClick={onClick} className="px-3 py-1 text-xs font-semibold rounded-full border transition-colors" style={{backgroundColor:bg,color:readable(bg),borderColor:border}}>{text}</button> }

    const Section = ({title, subtitle, children}) => (
      <section className="max-w-6xl mx-auto px-4">
        <div className="mb-4">
          <h2 className="text-2xl font-bold text-slate-800">{title}</h2>
          {subtitle && <p className="text-sm text-slate-600 mt-1">{subtitle}</p>}
        </div>
        {children}
      </section>
    );

    const projects=[
      { title:"Sejong Science Fellowship (Oversea Track)", org:"NRF", funded:true,  start:"2024-09-01", end:"2025-08-31" },
      { title:"Ph.D. Fellowship",                          org:"NRF", funded:true,  start:"2022-06-01", end:"2024-05-31" },
      { title:"Internal Study: Tokenization for TS",       org:"FINDS Lab", funded:false, start:"2025-02-01", end:"2025-12-31" },
      { title:"Pilot: Sports Betting Model",               org:"FINDS Lab", funded:false, start:"2023-01-01", end:"2023-06-30" },
    ];

    const isFinished = (end)=>{ try{ return new Date(end) < new Date(new Date().toISOString().slice(0,10)); }catch{return false;} };

    const Card=({p})=>{
      const finished=isFinished(p.end);
      return (
        <div className="p-5 bg-white rounded-xl border border-slate-200 card-hover">
          <div className="flex flex-wrap items-center gap-2">
            <Tag text={p.org}/>
            <Tag text={p.funded? 'Funded':'Not Funded'}/>
            <Tag text={finished? 'Finished':'Ongoing'}/>
          </div>
          <p className="mt-2 text-lg font-semibold text-slate-900">{p.title}</p>
          <p className="text-sm text-slate-600 mt-1">{p.start} → {p.end}</p>
        </div>
      )
    }

    const ProjectsPage=()=>{
      const [fundingSel,setFundingSel]=useState(new Set());
      const [statusSel,setStatusSel]=useState(new Set());
      const toggle=(setter,v)=> setter(prev=>{ const n=new Set(prev); n.has(v)?n.delete(v):n.add(v); return n; });
      const reset=()=>{ setFundingSel(new Set()); setStatusSel(new Set()); }
      const filtered = useMemo(()=> projects.filter(p=>{
        const fText=p.funded? 'Funded':'Not Funded';
        const sText=isFinished(p.end)? 'Finished':'Ongoing';
        if(fundingSel.size>0 && !fundingSel.has(fText)) return false;
        if(statusSel.size>0 && !statusSel.has(sText)) return false;
        return true;
      }),[fundingSel,statusSel]);

      return (
        <div className="min-h-screen">
          <div className="sticky-blur bg-white/80 border-b border-slate-200">
            <header className="max-w-6xl mx-auto px-4 py-5 flex items-center justify-between">
              <div>
                <h1 className="text-2xl sm:text-3xl font-extrabold tracking-tight text-slate-800">Projects</h1>
                <p className="text-sm text-slate-600">Funding / Status 필터</p>
              </div>
              <a href="./index.html" className="text-sm font-semibold underline decoration-2 underline-offset-4" style={{color:pickWarm('back')}}>Home</a>
            </header>
            <div className="max-w-6xl mx-auto px-4 pb-3">
              <div className="flex items-center gap-3 bg-slate-100/70 p-1 rounded-lg border border-slate-200">
                <div className="text-[12px] font-bold text-slate-600 pl-2">Results</div>
                <div className="text-2xl font-extrabold" style={{color:pickWarm('count')}}>{filtered.length}</div>
                <button onClick={reset} className="ml-auto px-3 py-2 text-xs sm:text-sm font-semibold rounded-md border border-slate-200 bg-white hover:bg-slate-50" style={{color:pickWarm('reset')}}>Reset</button>
              </div>
            </div>
          </div>

          <div className="sticky-blur bg-white/70 border-b border-slate-200">
            <div className="max-w-6xl mx-auto px-4 py-3 space-y-3">
              <div className="flex flex-wrap items-center gap-2">
                <span className="text-xs font-bold text-slate-600">Filter by Funding</span>
                {["Funded","Not Funded"].map(v=> <FilterChip key={v} text={v} selected={fundingSel.has(v)} onClick={()=>toggle(setFundingSel,v)}/>)
              </div>
              <div className="flex flex-wrap items-center gap-2">
                <span className="text-xs font-bold text-slate-600">Filter by End 여부</span>
                {["Ongoing","Finished"].map(v=> <FilterChip key={v} text={v} selected={statusSel.has(v)} onClick={()=>toggle(setStatusSel,v)}/>)
              </div>
            </div>
          </div>

          <main className="py-6">
            <Section title="Projects" subtitle="필터를 사용해 원하는 프로젝트만 보세요.">
              <div className="grid gap-4 sm:grid-cols-2">{filtered.map((p,i)=> <Card key={i} p={p}/>)}</div>
            </Section>
          </main>

          <footer className="max-w-6xl mx-auto px-4 py-10 text-center text-xs text-slate-500">© {new Date().getFullYear()} FINDS Lab. Projects</footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<ProjectsPage/>);
  </script>
</body>
</html>
