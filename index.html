<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FINDS Lab | Financial Data Science Lab. (Dongduk Woman's University)</title>
  <meta name="description" content="Financial Data Science Lab. (FINDS Lab.) — Dongduk Woman's University" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;900&family=Noto+Sans:wght@400;600;700;900&display=swap" rel="stylesheet">
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --accent: rgb(172, 14, 14);
      --gold:   rgb(214, 177, 77);
      --fg-on-accent:#ffffff;
      --bg:#ffffff;
      --bg-soft:#f8fafc;
      --ring:0 0 0 3px rgba(172,14,14,.25);
    }
    html,body{font-family:"Noto Sans KR","Noto Sans",system-ui,-apple-system,"Segoe UI",Arial,sans-serif;}
    body{background:var(--bg-soft)}
    .sticky-blur{position:sticky;top:0;z-index:50;backdrop-filter:saturate(180%) blur(8px);background:rgba(255,255,255,.85)}
    .nav-link{font-weight:800}
    .nav-link:hover{color:var(--accent)}
    .submenu-panel{font-size:13px; line-height:1.25rem; width:13.5rem}
    .submenu-item{padding:.35rem .75rem; font-weight:700}
    .btn-primary{background:var(--accent);color:var(--fg-on-accent);border-radius:.75rem;padding:.6rem .95rem;font-weight:900;box-shadow:0 6px 20px rgba(0,0,0,.12);transition:.2s}
    .btn-primary:hover{transform:translateY(-1px);opacity:.95}
    .btn-ghost{background:#0f172a;color:#fff;border-radius:.75rem;padding:.6rem .95rem;font-weight:900;box-shadow:0 6px 20px rgba(0,0,0,.12);transition:.2s}
    .btn-ghost:hover{transform:translateY(-1px);opacity:.95}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:1rem;padding:1.25rem;transition:.2s}
    .card:hover{transform:translateY(-2px);box-shadow:0 10px 28px rgba(0,0,0,.08)}
    .tag-gold{background:var(--gold);color:#111827;border-radius:9999px;padding:.25rem .55rem;font-size:.7rem;font-weight:900}
    .warm-underline{text-decoration:underline;text-decoration-thickness:2px;text-underline-offset:4px;text-decoration-color:var(--accent)}
    :focus-visible{outline:none;box-shadow:var(--ring)}

    .ko-tight{word-break:keep-all;line-break:strict;overflow-wrap:break-word;}
    @supports (text-wrap: balance){ .ko-tight{ text-wrap: balance; } }

    /* Carousel */
    .carousel{position:relative;overflow:hidden;border-radius:1.25rem;background:#0b1020}
    .carousel-track{display:flex;transition:transform .6s cubic-bezier(.2,.6,.2,1)}
    .carousel-slide{min-width:100%;height:520px;position:relative;background:#0b1020}
    .carousel-slide img{width:100%;height:100%;object-fit:cover;display:block}
    .carousel-caption{position:absolute;inset:0;display:flex;align-items:center;background:linear-gradient(90deg,rgba(0,0,0,.55),rgba(0,0,0,.15) 55%,rgba(0,0,0,0));color:#fff;padding:0 1rem}
    .dot{width:10px;height:10px;border-radius:9999px;background:#e5e7eb}
    .dot.active{background:var(--accent)}

    /* Scrollbar */
    *{scrollbar-width:thin;scrollbar-color:var(--accent) #f1f5f9}
    *::-webkit-scrollbar{height:8px;width:8px}
    *::-webkit-scrollbar-thumb{background:var(--accent);border-radius:9999px}

    /* Desktop submenu fade (header에서 사용) */
    .menu-group .js-submenu{visibility:hidden;opacity:0;transform:translateY(6px);transition:visibility .18s ease, opacity .18s ease, transform .18s ease}
    .menu-group.open .js-submenu{visibility:visible;opacity:1;transform:translateY(0)}

    /* 작은 디버그 패널 */
    #partials-debug{position:fixed;right:8px;bottom:8px;max-width:480px;background:#fff;border:1px solid #e5e7eb;border-radius:.75rem;padding:.6rem .8rem;font-size:12px;color:#334155;box-shadow:0 10px 28px rgba(0,0,0,.08);display:none}
    #partials-debug b{color:#0f172a}
    #partials-debug code{background:#f1f5f9;border:1px solid #e2e8f0;border-radius:.3rem;padding:0 .25rem}
  </style>
</head>
<body>
  <!-- Header (partial) -->
  <div id="site-header"></div>

  <!-- Hero -->
  <section class="max-w-7xl mx-auto px-4 mt-6">
    <div class="carousel" id="carousel" aria-roledescription="carousel">
      <div class="carousel-track" id="carouselTrack">
        <!-- Slide 1 -->
        <div class="carousel-slide">
          <img src="assets/img/hero/hero-1.jpg" alt="FINDS Lab Hero 1" onerror="this.style.display='none'" />
          <div class="carousel-caption">
            <div class="max-w-xl px-6">
              <span class="tag-gold">Financial Data Science Lab.</span>
              <h1 class="mt-3 text-[20px] md:text-[30px] lg:text-[40px] font-extrabold leading-tight ko-tight">
                Towards Data-Inspired Financial Management
              </h1>
              <div class="mt-4 flex gap-3">
                <a class="btn-primary text-sm" href="about-introduction.html">Read More</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Slide 2 -->
        <div class="carousel-slide">
          <img src="assets/img/hero/hero-2.jpg" alt="FINDS Lab Hero 2" onerror="this.style.display='none'" />
          <div class="carousel-caption">
            <div class="max-w-xl px-6">
              <span class="tag-gold">Financial Data Science Lab.</span>
              <h2 class="mt-3 text-[20px] md:text-[30px] lg:text-[40px] font-extrabold leading-tight ko-tight">
                Accomplishments
              </h2>
              <div class="mt-4 flex gap-3">
                <a class="btn-primary text-sm" href="publications.html">Publications</a>
                <a class="btn-primary text-sm" href="lectures.html">Lectures</a>
                <a class="btn-primary text-sm" href="projects.html">Projects</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Slide 3 -->
        <div class="carousel-slide">
          <img src="assets/img/hero/hero-3.jpg" alt="FINDS Lab Hero 3" onerror="this.style.display='none'" />
          <div class="carousel-caption">
            <div class="max-w-xl px-6">
              <span class="tag-gold">Financial Data Science Lab.</span>
              <h2 class="mt-3 text-[20px] md:text-[30px] lg:text-[40px] font-extrabold leading-tight ko-tight">
                Updates
              </h2>
              <div class="mt-4 flex gap-3">
                <a class="btn-primary text-sm" href="about-notice.html">Notice</a>
                <a class="btn-primary text-sm" href="archives-news.html">News</a>
                <a class="btn-primary text-sm" href="archives-seminar.html">Seminar</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Dots -->
      <div class="absolute bottom-3 left-0 right-0 flex items-center justify-center gap-2">
        <button class="dot" data-dot="0" aria-label="slide 1"></button>
        <button class="dot" data-dot="1" aria-label="slide 2"></button>
        <button class="dot" data-dot="2" aria-label="slide 3"></button>
      </div>
    </div>
  </section>

  <!-- Intro -->
  <section class="max-w-7xl mx-auto px-4 mt-10 grid lg:grid-cols-3 gap-6 items-center">
    <div class="lg:col-span-1">
      <img src="assets/img/brand/logo-finds.png" alt="FINDS Lab Logo" class="w-40 h-40 object-contain rounded-xl ring-1 ring-slate-200 bg-white p-3" />
    </div>
    <div class="lg:col-span-2">
      <p class="text-2xl font-extrabold tracking-tight" style="color:var(--accent)">Dongduk Woman's University</p>
      <h3 class="text-3xl mt-1">
        <span class="font-extrabold">Fin</span><span class="font-light">ancial</span>
        <span class="font-extrabold">D</span><span class="font-light">ata</span>
        <span class="font-extrabold">S</span><span class="font-light">cience</span>
        <span class="font-extrabold"> Lab. - </span>
        <span class="font-extrabold" style="color:rgb(214,177,77)">FINDS Lab.</span>
      </h3>
      <p class="mt-3 text-[15px] leading-7 text-slate-700">
        동덕여자대학교 경영학과 <b>금융데이터사이언스 연구실 (Financial Data Science)</b> 홈페이지입니다.
      </p>
      <div class="mt-5">
        <a class="btn-primary text-sm" href="about-introduction.html">Read More</a>
      </div>
    </div>
  </section>

  <!-- News & Notice -->
  <section class="max-w-7xl mx-auto px-4 mt-12 grid grid-cols-1 gap-6">
    <div class="card">
      <div class="flex items-center justify-between">
        <h4 class="text-xl font-extrabold">News</h4>
        <a class="warm-underline font-bold" href="archives-news.html">More</a>
      </div>
      <ul id="news-feed" class="mt-4 space-y-3">
        <li class="text-sm text-slate-500">불러오는 중…</li>
      </ul>
    </div>

    <div class="card">
      <div class="flex items-center justify-between">
        <h4 class="text-xl font-extrabold">Notice</h4>
        <a class="warm-underline font-bold" href="about-notice.html">More</a>
      </div>
      <ul id="notice-feed" class="mt-4 space-y-3">
        <li class="text-sm text-slate-500">불러오는 중…</li>
      </ul>
    </div>
  </section>

  <!-- Footer (partial) -->
  <div id="site-footer" class="mt-10"></div>

  <!-- 디버그 패널 -->
  <div id="partials-debug"></div>

  <!-- Scripts -->
  <script defer>
    /***********************  강력한 Partial 로더  ***********************/
    // 필요 시 수동 지정 (예: window.PARTIALS_BASE = '/my-site/';)
    // 필요 시 커스텀 폴더 후보 (예: window.PARTIALS_DIRS = ['partials/','common/'];)
    // 필요 시 파일명 후보 (예: window.PARTIALS_FILES = { header:['headers.html','header.html'] , footer:['footers.html','footer.html'] })

    function unique(arr){ return [...new Set(arr.filter(Boolean))]; }
    function nowQS(){ return `cb=${Date.now()}`; }

    function guessBase(){
      const host = location.hostname;
      const parts = location.pathname.split('/').filter(Boolean);

      // 1) raw.githubusercontent.com/user/repo/branch/...
      if (host === 'raw.githubusercontent.com' && parts.length >= 3){
        return '/' + parts.slice(0,3).join('/') + '/';
      }
      // 2) GitHub Pages (user.github.io/repo/…)
      if (host.endsWith('github.io') && parts.length >= 1){
        return '/' + parts[0] + '/';
      }
      // 3) 일반/커스텀 도메인 → 루트
      return '/';
    }

    function currentDir(){
      // 현재 문서의 디렉토리 경로 (파일명 제거)
      return location.pathname.endsWith('/') ? location.pathname : location.pathname.replace(/[^/]+$/, '');
    }

    async function injectPartial(elId, kind /* 'header' | 'footer' */){
      const hostEl = document.getElementById(elId);
      if(!hostEl) return;

      const debugEl = document.getElementById('partials-debug');
      const tried = [];

      if (location.hostname === 'github.com'){
        hostEl.innerHTML = '<div class="max-w-7xl mx-auto px-4 py-3 text-amber-700 text-sm font-bold bg-amber-50 rounded-lg border border-amber-200">⚠️ GitHub 코드 보기 페이지에서는 partial을 불러올 수 없습니다. GitHub Pages 또는 raw.githubusercontent.com, 혹은 로컬 서버에서 확인하세요.</div>';
        return;
      }
      if (location.protocol === 'file:'){
        hostEl.innerHTML = '<div class="max-w-7xl mx-auto px-4 py-3 text-amber-700 text-sm font-bold bg-amber-50 rounded-lg border border-amber-200">로컬 파일(file://)에서는 fetch가 차단됩니다. VS Code Live Server 등으로 띄워주세요.</div>';
        return;
      }

      const BASE = (window.PARTIALS_BASE || guessBase()).replace(/\/+$/,'/') + '';
      const bases = unique([ BASE, '/', currentDir() ]);

      const defaultDirs = ['','partials/','includes/','_includes/','assets/','assets/partials/','assets/includes/','components/','common/','shared/'];
      const dirs = unique([ ...(window.PARTIALS_DIRS || []), ...defaultDirs ]);

      const defaults = kind === 'header'
        ? ['headers.html','header.html']
        : ['footers.html','footer.html'];
      const files = unique([ ...(window.PARTIALS_FILES?.[kind] || []), ...defaults ]);

      const urls = [];
      for (const b of bases){
        for (const d of dirs){
          for (const f of files){
            const base = b.endsWith('/') ? b : (b + '/');
            const dir  = d ? (d.endsWith('/') ? d : d + '/') : '';
            urls.push(base + dir + f);
          }
        }
      }
      // 현재 폴더 직접/상위도 끝에 추가 (상대경로 보호)
      files.forEach(f => {
        urls.push(f);
        urls.push('./' + f);
        urls.push('../' + f);
      });

      let lastErr = '';
      for (const u of urls){
        const finalUrl = u + (u.includes('?') ? '&' : '?') + nowQS();
        tried.push(finalUrl);
        try{
          const res = await fetch(finalUrl, { cache: 'no-store' });
          if(res.ok){
            hostEl.innerHTML = await res.text();
            // footer라면 연도 자동 세팅
            if (kind === 'footer'){
              const y = new Date().getFullYear();
              const span = document.getElementById('year');
              if(span) span.textContent = y;
            }
            return;
          }
          lastErr = `HTTP ${res.status}`;
        }catch(e){
          lastErr = e + '';
        }
      }

      hostEl.innerHTML = '<div class="max-w-7xl mx-auto px-4 py-3 text-rose-700 text-sm font-bold bg-rose-50 rounded-lg border border-rose-200">공통 영역을 불러오지 못했습니다.</div>';
      // 디버그 패널에 시도한 URL 나열
      try{
        debugEl.style.display = 'block';
        debugEl.innerHTML = '<b>partials 로드 실패</b><div style="margin:.35rem 0 .25rem 0">마지막 오류: <code>'+ (lastErr||'') +'</code></div><div style="max-height:160px;overflow:auto"><ol style="padding-left:1.1rem;margin:.25rem 0 0 0;">'
          + tried.map(t => '<li><code>'+ t.replace(/&/g,'&amp;').replace(/</g,'&lt;') +'</code></li>').join('')
          + '</ol></div>';
      }catch(_){}
    }

    function initHeaderInteractions(){
      const btnMobile = document.getElementById('btnMobile');
      const mobileNav = document.getElementById('mobileNav');
      btnMobile?.addEventListener('click', ()=> mobileNav?.classList.toggle('hidden'));

      const MENU_DELAY = 70; // ms
      document.querySelectorAll('.menu-group[data-menu]').forEach((grp)=>{
        const panel = grp.querySelector('.js-submenu');
        if(!panel) return;
        let t;
        const open  = ()=>{ clearTimeout(t); grp.classList.add('open'); };
        const close = ()=>{ t = setTimeout(()=> grp.classList.remove('open'), MENU_DELAY); };
        grp.addEventListener('mouseenter', open);
        grp.addEventListener('mouseleave', close);
        grp.addEventListener('focusin', open);
        grp.addEventListener('focusout', close);
      });
    }

    (async ()=>{
      await injectPartial('site-header', 'header');  // headers.html / header.html 자동 시도
      initHeaderInteractions();
      await injectPartial('site-footer', 'footer');  // footers.html / footer.html 자동 시도
    })();

    /***********************  Carousel  ***********************/
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));

    window.addEventListener('DOMContentLoaded', () => {
      const track = $('#carouselTrack');
      const dots  = $$('[data-dot]');
      if (!track || dots.length === 0) return;

      let idx = 0;
      const total = track.children.length;
      let timer;

      const go = (i) => {
        idx = (i + total) % total;
        track.style.transform = `translateX(-${idx * 100}%)`;
        dots.forEach((d, j) => d.classList.toggle('active', j === idx));
      };
      const auto = () => { timer = setInterval(() => go(idx + 1), 5000); };

      dots.forEach((d) => d.addEventListener('click', () => {
        clearInterval(timer);
        go(+d.dataset.dot);
        auto();
      }));
      go(0); auto();
    });

    /***********************  News / Notice 임베드  ***********************/
    async function importList(srcUrl, listSelectors, targetId, limit = 3){
      const target = document.getElementById(targetId);
      if (!target) return;

      if (location.protocol === 'file:') {
        target.innerHTML = '<li class="text-sm text-amber-600">로컬 파일로 열면 임베드가 차단됩니다. 로컬 서버에서 접속해 주세요.</li>';
        return;
      }

      // GitHub Pages나 raw에서도 동작
      try {
        const res = await fetch(srcUrl, { cache: 'no-store' });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');

        let items = [];
        const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));
        for (const sel of listSelectors) {
          items = $$(sel, doc);
          if (items.length) break;
        }

        target.innerHTML = '';
        if (items.length === 0) {
          target.innerHTML = '<li class="text-sm text-slate-500">게시글이 없습니다.</li>';
          return;
        }

        items.slice(0, limit).forEach((li) => target.appendChild(li.cloneNode(true)));
      } catch (err) {
        console.error('임베드 오류:', err);
        target.innerHTML = '<li class="text-sm text-slate-500">불러오기 실패</li>';
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      importList('archives-news.html',
        ['#news-list > li', '#news ul > li', 'ul#news > li', 'main ul > li'],
        'news-feed', 3
      );
      importList('about-notice.html',
        ['#notice-list > li', '#notices ul > li', 'ul#notice > li', 'main ul > li'],
        'notice-feed', 3
      );
    });
  </script>
</body>
</html>
